<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gerador de Senhas Seguras</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 20px;
            height: 20px;
            background: #4f46e5; /* indigo-600 */
            cursor: pointer;
            border-radius: 50%;
        }
        input[type="range"]::-moz-range-thumb {
            width: 20px;
            height: 20px;
            background: #4f46e5;
            cursor: pointer;
            border-radius: 50%;
        }
    </style>
</head>
<body class="bg-gray-900 text-gray-100 flex items-center justify-center min-h-screen font-sans">

    <div class="w-full max-w-md bg-gray-800 rounded-2xl shadow-lg p-8 m-4">
        
        <h1 class="text-3xl font-bold text-center text-indigo-400 mb-2">Gerador de Senhas</h1>
        <p class="text-center text-gray-400 mb-8">Crie senhas fortes e seguras com um clique.</p>

        <div class="relative mb-6">
            <input type="text" id="password-display"
                   class="w-full bg-gray-900 text-gray-200 text-lg p-4 rounded-lg border-2 border-gray-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition"
                   readonly placeholder="Sua senha aparecerá aqui...">
            <button id="copy-button" class="absolute top-1/2 right-4 transform -translate-y-1/2 text-gray-400 hover:text-indigo-400 transition" title="Copiar senha">
                <i class="fas fa-copy fa-lg"></i>
            </button>
            <span id="copy-feedback" class="absolute top-1/2 right-12 transform -translate-y-1/2 text-sm text-green-400 opacity-0 transition-opacity">Copiado!</span>
        </div>

        <div class="space-y-6">
            <div class="flex items-center justify-between">
                <label for="length" class="text-lg font-medium">Comprimento da Senha</label>
                <span id="length-value" class="text-2xl font-bold text-indigo-400 w-12 text-center">16</span>
            </div>
            <input type="range" id="length" min="4" max="64" value="16"
                   class="w-full h-2 bg-gray-700 rounded-lg appearance-none cursor-pointer">

            <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
                <div class="flex items-center bg-gray-700 p-3 rounded-lg">
                    <input id="uppercase" type="checkbox" checked class="w-5 h-5 text-indigo-500 bg-gray-900 border-gray-600 rounded focus:ring-indigo-600 ring-offset-gray-800 focus:ring-2">
                    <label for="uppercase" class="ml-3 text-md font-medium text-gray-300">Incluir Maiúsculas (A-Z)</label>
                </div>
                <div class="flex items-center bg-gray-700 p-3 rounded-lg">
                    <input id="numbers" type="checkbox" checked class="w-5 h-5 text-indigo-500 bg-gray-900 border-gray-600 rounded focus:ring-indigo-600 ring-offset-gray-800 focus:ring-2">
                    <label for="numbers" class="ml-3 text-md font-medium text-gray-300">Incluir Números (0-9)</label>
                </div>
                <div class="flex items-center bg-gray-700 p-3 rounded-lg">
                    <input id="symbols" type="checkbox" checked class="w-5 h-5 text-indigo-500 bg-gray-900 border-gray-600 rounded focus:ring-indigo-600 ring-offset-gray-800 focus:ring-2">
                    <label for="symbols" class="ml-3 text-md font-medium text-gray-300">Incluir Símbolos (!@#)</label>
                </div>
            </div>
        </div>

        <button id="generate-button" class="w-full mt-8 bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-4 px-4 rounded-lg text-lg transition-transform transform hover:scale-105 focus:outline-none focus:ring-4 focus:ring-indigo-500 focus:ring-opacity-50 flex items-center justify-center gap-2">
            <i class="fas fa-bolt"></i>
            Gerar Senha
            <span id="loading-spinner" class="hidden animate-spin h-5 w-5 border-2 border-white border-t-transparent rounded-full"></span>
        </button>
        
        <div id="error-message" class="text-red-400 text-center mt-4 h-6"></div>

    </div>

    <script>
        const lengthSlider = document.getElementById('length');
        const lengthValue = document.getElementById('length-value');
        const generateButton = document.getElementById('generate-button');
        const passwordDisplay = document.getElementById('password-display');
        const copyButton = document.getElementById('copy-button');
        const copyFeedback = document.getElementById('copy-feedback');
        const errorMessage = document.getElementById('error-message');
        const loadingSpinner = document.getElementById('loading-spinner');

        const API_URL = 'http://127.0.0.1:5000/generate-password';

        lengthSlider.addEventListener('input', () => {
            lengthValue.textContent = lengthSlider.value;
        });

        async function generatePassword() {
            loadingSpinner.classList.remove('hidden');
            generateButton.disabled = true;
            errorMessage.textContent = '';
            
            const includeUppercase = document.getElementById('uppercase').checked;
            const includeNumbers = document.getElementById('numbers').checked;
            const includeSymbols = document.getElementById('symbols').checked;
            const length = lengthSlider.value;

            const queryParams = new URLSearchParams({
                length: length,
                uppercase: includeUppercase,
                numbers: includeNumbers,
                symbols: includeSymbols
            });

            try {
                const response = await fetch(`${API_URL}?${queryParams}`);
                const data = await response.json();

                if (response.ok) {
                    passwordDisplay.value = data.password;
                } else {
                    passwordDisplay.value = '';
                    errorMessage.textContent = data.error || 'Erro ao gerar senha.';
                }
            } catch (error) {
                console.error('Falha na comunicação com a API:', error);
                passwordDisplay.value = '';
                errorMessage.textContent = 'Não foi possível conectar à API.';
            } finally {
                loadingSpinner.classList.add('hidden');
                generateButton.disabled = false;
            }
        }

        function copyPassword() {
            if (!passwordDisplay.value) return;

            const textarea = document.createElement('textarea');
            textarea.value = passwordDisplay.value;
            document.body.appendChild(textarea);
            textarea.select();
            document.execCommand('copy');
            document.body.removeChild(textarea);

            copyFeedback.style.opacity = '1';
            setTimeout(() => {
                copyFeedback.style.opacity = '0';
            }, 2000);
        }

        generateButton.addEventListener('click', generatePassword);
        copyButton.addEventListener('click', copyPassword);

        window.addEventListener('load', generatePassword);
    </script>
</body>
</html>
